USE TEST
GO
SELECT * INTO #f_Trans_GL1 FROM f_Trans_GL
GO
CREATE TABLE #SpecID (id INT IDENTITY(1,1), MemberID INT)
INSERT INTO #SpecID
SELECT DISTINCT MemberID FROM d_Dim0
WHERE MemberID NOT IN (SELECT DISTINCT Dim0 FROM f_Trans_GL)
GO
CREATE TABLE #f_trans (fid INT IDENTITY(1,1), Dim0 INT)
INSERT INTO #f_Trans
SELECT DISTINCT Dim0 FROM f_Trans_GL

DECLARE @id INT
SET @id = 1
WHILE @id <= (SELECT MAX(fid) FROM #f_trans)
BEGIN
UPDATE #f_Trans_GL1
SET Dim0 = (SELECT MemberID FROM #SpecID WHERE id = @id)
WHERE Dim0 = (SELECT Dim0 FROM #f_trans WHERE fid= @id)
SET @id = @id + 1
END

SELECT * FROM #f_Trans_GL1
DROP TABLE #f_Trans_GL1, #SpecID, #f_trans
